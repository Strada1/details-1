import { UI_ITEMS } from "./view.js"

const STATUS  = {
TO_DO: "To Do",
Done: "Done",
}

const PRIORITY = {
High: "high",
Low: "low",
}

UI_ITEMS.form_High.addEventListener("submit", addtask_High)
UI_ITEMS.form_Low.addEventListener("submit", addtask_Low)

const list = [];

function Task(task, prioritet) {
	this.Name = task;
	this.status = STATUS.TO_DO;
	this.priority = prioritet;
}

function addtask_High () {
	try {
		const value_input = UI_ITEMS.input_High.value;
		
		const indexObj = list.findIndex(function(item){
			return item.Name == value_input;
		})
		if (indexObj == -1) {
			const tasks = new Task(value_input, PRIORITY.High)
			list.push(tasks) 

			render(event)
		} else {
			alert("Уже есть такая задача")
		}

	} catch (err) {
		alert(err)
	}
}

function addtask_Low () {

	try {
		const value_input = UI_ITEMS.input_Low.value;
		const indexObj = list.findIndex(function(item){
			return item.Name == value_input;
		})
		if (indexObj == -1) {
			const tasks = new Task(value_input, PRIORITY.Low)
			list.push(tasks) 

			render(event)
		} else {
			alert("Уже есть такая задача")
		}

	} catch (err) {
		alert(err)
	}
}

function deleteTask(event) {
	alert('klik')
	try {
		let task = event.target.parentNode.innerText
		task = task.trim()

		const IndexObj = list.findIndex(function(item){
			return item.Name == task
		  })
		  
			list.splice(IndexObj, 1)

			render(event)

	} catch (err) {
		alert(err)
	}
}

function changePriority(event) {
	
	try {
		let checkboxOn = event.target.parentNode.innerText
		checkboxOn = checkboxOn.trim()
		console.log(checkboxOn)

		const indexObj = list.findIndex(function(item){
			return item.Name == checkboxOn
		  })

		  console.log(indexObj)
		
			render(event)

	} catch (err) {
		alert(err)
	}
  }

function render (event) {
	try {
		event.preventDefault();

		UI_ITEMS.task_High.innerHTML = ""
		UI_ITEMS.task_Low.innerHTML = ""

		list.forEach(function(item) {

			if (item.status === STATUS.TO_DO && item.priority === PRIORITY.High) {

				UI_ITEMS.task_High.insertAdjacentHTML("afterbegin", 
				`
				<div> 
					<label class="input_checkbox" id="input_checkbox">
						<input type="checkbox" name="value" value="option" onclick="changePriority(event)">
						<input type="submit" value="&#9746" class="btn_close" id="close_Task" onclick="deleteTask(event)">
						${item.Name}
					</label>
				</div>
				`
			)
				UI_ITEMS.form_High.reset()

			} else if (item.status === STATUS.TO_DO && item.priority === PRIORITY.Low) {
				UI_ITEMS.task_Low.insertAdjacentHTML("afterbegin", 
					`
					<div> 
						<label class="input_checkbox" id="input_checkbox">
							<input type="checkbox" name="value" value="option" onclick="changePriority(event)">
							<input type="submit" value="&#9746" class="btn_close" id="close_Task" onclick="deleteTask(event)">
							${item.Name}
						</label>
					</div>
					`
			)
			UI_ITEMS.form_Low.reset()
			}
		})

	} catch (err) {
		alert(err)
	}
}


Функцию delete task почему-то не видно...